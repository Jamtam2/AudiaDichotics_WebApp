<!--Test page for RDDT List 1 Contains everything for completing and submitting a test  -->
<!--this tests interpretation is identical to DWT just with different normative values, NOTE: the interpretation and ear advantge is only based on the 2 button pairs and no others-->
<body id= "defBG">
  <div class="container p-5 my-3 w-100 border rounded bg-white ">

    <div data-list-type=<%= data_list_type%> ></div>

    <h1 class= "display-5", style= 'padding-bottom:20px' ><strong><%= "Testing " + @client.first_name + " " + @client.last_name%></strong></h1>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    
    <!--Test page for RDDT List 1 Contains everything for completing and submitting a test  -->
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>

    <style>
      div.sticky {
        position: -webkit-sticky; /* Safari */
        position: sticky;
        top: 0;
      }
    </style>

    <div class="container">
      <%= form_with model: [@client, controller], local: true, html: { multipart: true } do |f| %>
        <%= f.hidden_field :category_id, value: controller.category_id %>
        <div class="row">
          <div class="form-group row">
            <div class="col-sm">
              <div class="form-group row ">
                <label for="exampleLabel">Label</label>
                <%= f.text_field :label, class: "form-control", type: "text", id: "exampleLabel", value: example_label %>
              </div>
              <div class="form-group row ">
                <label for="clientName">Client</label>
                <input class="form-control" type="text" id="clientName" placeholder="<%= @client.first_name + ' ' + @client.last_name %>" readonly />
              </div>
              <div class="form-group row ">
                <label for="testType">Type</label>
                <input class="form-control" type="text" id="testType" placeholder="<%= part_prefix %>" readonly />
              </div>
              <hr/>

              <!--Conditions are just for the test giver to determine, all tests are pretty much free recall unless test giver is doing specific procedure -->
              <%= render partial: 'test_partials/condition/condition_' << part_prefix %>
              <hr/>
    
              <div class="sticky">
                <p>Notes</p>
                <%= f.text_area :notes, class: 'form-control', rows: '3' %>
                <hr/>
                
                <!--AUDIO PLAYER FOR AUDIO FILES STORED IN ASSETS/AUDIO/ETC.MP3-->
                <audio id="audioPlayer">
                  <source src="<%= asset_path(audio_asset) %>" type="<%= audio_type %>" />
                </audio>
                
                <!-- AUDIO PLAYER CONTROLS -->
                <button id="startAudioBtn" type="button" class="btn btn-info" disabled>Start Audio</button>
                <button id="stopAudioBtn" type="button" class="btn btn-info" disabled>Stop Audio</button>
                <span id="audioTimeContainer"><i>Loading...</i></span>
                <hr/>

                <!--Table for ear advantage percentage that is calculated in the script-->
                <style>
                  .left-column {
                    background-color: lightblue;
                  }

                  .right-column {
                    background-color: lightpink;
                  }

                  .ear-advantage {
                    background-color: white;
                  }

                  .ear-advantage.positive {
                    background-color: lightblue;
                  }

                  .ear-advantage.negative {
                    background-color: lightpink;
                  }
                </style>


                <p>Scores:</p>
                <%= render partial: 'test_partials/scores/scores_' << part_prefix%>
            
                <!--Table for ear advantage that is calculated in the script and ear diagnosis/interpretation-->
                <label for="read-Only">Ear Advantage</label>
                <input class="form-control" type="text" id="read-Only" value="" readonly>
                <span hidden id="advantage-Name"></span>
                <label for="read-Only">Interpretation</label>
                <input class="form-control" type="text" id="read-Only-diag" value="" readonly>
                <span hidden id="Diagnosis"></span>
                <hr/>
                
                <!--percentile is how good the current score is based on data collected for children that age. this can be either within normal limits, 25th percentile, 10th percentile, 5th percentile in order of best to worst -->
                <!-- dnw doesn't have one of these -->
                <%= render partial: 'test_partials/percentile/percentile_' << part_prefix %>
              </div>
            </div>
          </div>
          <style>
            /* Center buttons in the table cells */
            .btn-group-toggle {
              display: flex;
              justify-content: center;
              align-items: center;
              height: 100%;
            }

            /* Make the font larger */
            .btn.btn-outline-primary {
              font-size: 16px; /* Adjust the font size as needed */
              margin: 5px; /* Add some margin to separate the buttons */
              min-width: 40px; /* Adjust the minimum width as needed */
            }
          </style>

          <div class="col-sm">
            <table class="table table-sm table-striped ml-4">
              <thead class="thead-dark">
                <tr>
                  <th>Number</th>
                  <th>Left</th>
                  <th>Right</th>
                </tr>
              </thead>

              <tbody>
                <%= render partial: 'test_partials/wordtable/wordtable_' << part_prefix, locals: {words: words} %>
              </tbody>
            </table>
          </div>
        </div>
          
        <!-- Existing form fields -->
        
        <%= render partial: 'test_partials/formfields/formfields_' << part_prefix, locals: { f: f } %>
        <%= f.submit "Submit", class: "btn btn-primary btn-block", onclick: "populateHiddenFields()" %>
      <% end %>

      
    </div>
  </div>
  
  <div id="client-data" data-age="<%= @client.age_in_years %>"></div>


<!--this is just a storage of variable in the html outside of the js so that they can be pulled to the forms above -->
    <div>
      <p><span hidden id="column1-count"></span></p>
      <p><span id="column1-percent"></span></p>
      <p><span hidden id="column2-count"></span></p>
      <p><span id="column2-percent"></span></p>
      <p><span id="advantage-Diff"></span></p>
      <p><span id="left-percentile"></span></p>
      <p><span id="right-percentile"></span></p>
      <p><span id="advantage-percentile"></span></p>

      <p><span id="column1Group1-percent"></span></p>
      <p><span id="column1Group2-percent"></span></p>
      <p><span id="column1Group3-percent"></span></p>

      <p><span id="column2Group1-percent"></span></p>
      <p><span id="column2Group2-percent"></span></p>
      <p><span id="column2Group3-percent"></span></p>

      <p><span id="Group1advantage-Diff"></span></p>
      <p><span id="Group2advantage-Diff"></span></p>
      <p><span id="Group3advantage-Diff"></span></p>
    </div>

  </body>
</html>

